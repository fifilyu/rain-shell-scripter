编号,模式,命令,返回代码,返回类型,返回值,过滤器,变量名,提示信息
B00,CONST,NULL,NULL,STR,hello,NULL,PROJECT,设置项目名称
B01,MESSAGE,NULL,NULL,NULL,NULL,NULL,NULL,开始......构建项目——${PROJECT}
B02,CMD,pwd,0,STR,NULL,NULL,pwd,获取当前工作目录
B03,ENV,NULL,NULL,NULL,${pwd},NULL,JAVA_HOME,"设置环境变量""WORK_DIR"""
B04,CMD,mkdir -p target && touch target/hello-1.0.0.jar,0,NULL,NULL,NULL,NULL,模拟->Maven构建项目——${PROJECT}
B05,CMD,ls target/hello-*.jar,0,NULL,NULL,NULL,NULL,模拟->确认构建后存在target文件（JAR包）
B06,CMD,basename target/hello-*.jar,0,STR,NULL,NULL,target_file,模拟->获取target文件名称
B07,CMD,echo scp target/${target_file} root@x.x.x.x:/data/hello/${target_file},0,NULL,NULL,NULL,NULL,模拟->上传项目${PROJECT}的JAR文件到目标环境
B08,CMD,md5sum target/${target_file},0,NULL,NULL,^([\d\w]+) .*$,local_hash,模拟->本地环境-生成JAR包的哈希值
B09,CMD,echo ${local_hash},0,NULL,NULL,NULL,remote_hash,模拟->目标环境-生成JAR包的哈希值
B10,STATEMENT,'${local_hash}' == '${remote_hash}',NULL,INT,1,NULL,NULL,模拟->对比JAR包的哈希值
B11,CMD,echo ssh root@x.x.x.x 'rm -f /data/hello/lastest.jar',0,NULL,NULL,NULL,NULL,模拟->目标环境-删除系统服务依赖的JAR包软链接
B12,CMD,echo ssh root@x.x.x.x 'ln -s /data/hello/${target_file} /data/hello/lastest.jar',0,NULL,NULL,NULL,NULL,模拟->目标环境-重建系统服务依赖的JAR包软链接
B13,CMD,echo ssh root@x.x.x.x 'systemctl restart hello',0,NULL,NULL,NULL,NULL,模拟->目标环境-重启${PROJECT}服务
B14,CMD,echo ssh root@x.x.x.x 'systemctl status hello',0,NULL,NULL,NULL,NULL,模拟->目标环境-查看${PROJECT}服务状态
B15,CMD,rm -rf target/,0,NULL,NULL,NULL,NULL,模拟->目标环境-删除构建目录
B16,MESSAGE,NULL,NULL,NULL,NULL,NULL,NULL,结束......构建项目——${PROJECT}